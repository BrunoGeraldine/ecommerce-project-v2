name: Daily Sync - Google Sheets to Supabase

on:
  schedule:
    # Roda todo dia Ã s 3h da manhÃ£ (UTC)
    - cron: '0 3 * * *'
  
  # Permite execuÃ§Ã£o manual
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout cÃ³digo
        uses: actions/checkout@v3
      
      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'
      
      - name: Instalar dependÃªncias
        run: |
          pip install gspread oauth2client supabase python-dotenv
      
      - name: Criar arquivo de credenciais
        run: |
          mkdir -p credentials
          echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials/credentials.json
      
      - name: Executar sincronizaÃ§Ã£o
        env:
          SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
          SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}
          SPREADSHEET_NAME: ${{ secrets.SPREADSHEET_NAME }}
        run: |
          python sync_sheets.py
      
      - name: Limpar credenciais
        if: always()
        run: |
          rm -rf credentials/
```

---

## **ðŸ“Š RESUMO DA ESTRATÃ‰GIA**

| AÃ§Ã£o | Script | FrequÃªncia |
|------|--------|-----------|
| **Setup inicial** | `validate_and_import.py` | 1 vez |
| **Adicionar novos dados** | `sync_sheets.py` (manual ou automÃ¡tico) | Quando quiser |
| **SincronizaÃ§Ã£o automÃ¡tica** | GitHub Actions â†’ `sync_sheets.py` | Todo dia 3h |
| **Debug de problemas** | `validate_and_import.py` | Quando necessÃ¡rio |

---

## **ðŸŽ¯ WORKFLOW RECOMENDADO**
```
DIA 1 (Hoje):
â”œâ”€ Executar validate_and_import.py (setup inicial)
â”œâ”€ Verificar dados no Supabase
â””â”€ Configurar GitHub Actions

DIA 2 EM DIANTE:
â””â”€ GitHub Actions roda sync_sheets.py automaticamente Ã s 3h

QUANDO ADICIONAR DADOS NO SHEETS:
â”œâ”€ OpÃ§Ã£o 1: Esperar atÃ© 3h (automÃ¡tico)
â””â”€ OpÃ§Ã£o 2: Rodar sync_sheets.py manualmente